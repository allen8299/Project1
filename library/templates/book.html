{% extends "frontstage.html" %}
{% block head %}
{{ super() }}
{% endblock head %}

{% block title %}library{% endblock title%}

{% block content %}

{% with messages = get_flashed_messages() %}
{% if messages[0] == 'Reserve Error' %}
<script language="javascript">
  alert('é ç´„æ—¥æœŸä¸å¾—å°æ–¼ç­‰æ–¼ä»Šå¤©æ—¥æœŸï¼');
</script>
{% elif messages[0] == 'Reserve Success' %}
<script language="javascript">
  alert('é ç´„æˆåŠŸï¼');
</script>
{% endif %}
{% endwith %}

{% set temp = 'book/' + data.æ›¸ç±ç·¨è™Ÿ + '.jpeg'%}


<div class="product_content">
  <div class="row justify-content-center">
    <div class="card" style="width: 20rem;margin-left:5%">

      <img src={{ url_for('static', filename=temp ) }} onerror="this.src='/static/img/sdg.jpg'" class="card-img-top">
    </div>
    <div class="col-sm-6">
      <form method="post" action={{ url_for('library.book_reserve') }}>
        <div class="card">
          <div class="card-body">
            <span class="badge rounded-pill bg-info text-dark">{{ data.æ›¸ç±é¡åˆ¥ }}</span>
            <span class="badge rounded-pill bg-warning text-dark">{{ data.æ›¸ç±ä¸»é¡Œ }}</span>
            <h5 class="card-title mt-3">{{ data.æ›¸ç±åç¨± }}</h5>
            <ul class="card-text">
              <li>æ›¸ç±ç·¨è™Ÿï¼š{{data.æ›¸ç±ç·¨è™Ÿ }}</li>
              <li>ä½œè€…ï¼š{{data.ä½œè€… }}</li>
              <li>å‡ºç‰ˆç¤¾ï¼š{{data.å‡ºç‰ˆç¤¾ }}</li>
              <li>å‡ºç‰ˆæ—¥æœŸï¼š{{data.å‡ºç‰ˆæ—¥æœŸ }}</li>
              {% if book_is_borrowed == True %}
              <li>å€Ÿé–±ç‹€æ…‹ï¼šå€Ÿé–±ä¸­</li>
              {% endif %}
              {% if book_is_reserved == True %}
              <li>é ç´„ç‹€æ…‹ï¼šé ç´„ä¸­</li>
              {% endif %}
            </ul>

            {% if book_is_reserved == True %}
            &nbsp;<button type="button" class="btn btn-outline-primary" data-bs-toggle="modal"
              data-bs-target="#review_staticBackdrop" disabled>
              é ç´„æ›¸ç±
            </button>
            {% else %}
            &nbsp;<button type="button" class="btn btn-outline-primary" data-bs-toggle="modal"
              data-bs-target="#review_staticBackdrop">
              é ç´„æ›¸ç±
            </button>
            {% endif %}
            {% if book_is_borrowed == True %}
            &nbsp;<button class="btn btn-outline-success" type="submit" value="{{data.æ›¸ç±ç·¨è™Ÿ}}" name="borrow"
              disabled>å€Ÿé–±æ›¸ç±</button>
            {% else %}
            &nbsp;<button class="btn btn-outline-success" type="submit" value="{{data.æ›¸ç±ç·¨è™Ÿ}}"
              name="borrow">å€Ÿé–±æ›¸ç±</button>
            {% endif %}

            &nbsp;<button class="btn btn-outline-dark" type="submit" value="{{data.æ›¸ç±ç·¨è™Ÿ}}" name="review">è©•è«–æ›¸ç±</button>
            &nbsp;<a href="{{ url_for('library.library') }}" class="btn btn-outline-secondary">å›æ›¸ç±åˆ—è¡¨</a>

          </div>
        </div>
        <div class="card">
          <div class="card-body">
            <h3><span>è©•åˆ†/è©•è«–</span></h3>
            <div class="fraction">
              <label>å¹³å‡åˆ†æ•¸ï¼š</label>
              <label>5.0</label>
            </div>
            <div class="then">
              <label>ç¸½è©•è«–æ•¸ï¼š</label>
              <label>2</label>
            </div>
          </br>
            <div class="bookcomment slick-initialized slick-slider">
              <div class="slick-list draggable">
                <div class="slick-track" style="opacity: 1; width: 536px; transform: translate3d(0px, 0px, 0px);">
                  <div class="slick-slide slick-current slick-active" style="width: 268px;" tabindex="-1"
                    data-slick-index="0" aria-hidden="false">
                    <div class="commentblock">
                      <div class="name">æ—*è†</div>
                      <p id="comment">Allenè€å¸«çœŸå¸¥ï¼Œå€¼å¾—ğŸ‘</p>
                    </div>
                  </div>
                  <div class="slick-slide slick-active" style="width: 268px;" tabindex="-1" data-slick-index="1"
                    aria-hidden="false">
                    <div class="commentblock">
                      <div class="name">é™³*æ™º</div>
                      <p id="comment">ä»‹ç´¹å¾ˆå¤šé—œæ–¼å­¸ç¿’çš„æ–¹æ³•èˆ‡æŠ€å·§ï¼Œå…¶ä¸­æ’°å¯«è®€æ›¸ç­†è¨˜çš„ç« ç¯€å°¤å…¶æ¨è–¦ï¼Œä¸å‰ç…§è‘—åšï¼Œæ”¶ç©«å¾ˆå¤§ã€‚</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- é ç´„æ›¸ç±Modal -->
        <div class="modal fade" id="review_staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false"
          tabindex="-1" aria-labelledby="review_staticBackdropLabel" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="review_staticBackdropLabel">é ç´„æ›¸ç±</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body">
                <div class="mb-3">
                  <!-- æ—¥æœŸè¼¸å…¥æ¬„ä½ -->
                  <p>é ç´„æ—¥æœŸ: <input type="text" id="datepicker" name="reserve_date" required></p>
                </div>
              </div>
              <div class="modal-footer">
                <button class="btn btn-outline-primary" type="submit" value="{{data.æ›¸ç±ç·¨è™Ÿ}}" name="reserve">é ç´„æ›¸ç±</button>
                <button type="button" class="btn btn-danger" data-bs-dismiss="modal">å–æ¶ˆ</button>
              </div>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>
<link rel="stylesheet" href="//code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css">
<link rel="stylesheet" href="/resources/demos/style.css">
<script src="https://code.jquery.com/jquery-3.6.0.js"></script>
<script src="https://code.jquery.com/ui/1.13.2/jquery-ui.js"></script>
<script>
  $(function () {
    $("#datepicker").datepicker();
  });
</script>

{% endblock content%}